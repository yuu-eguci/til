
# ios tips ノ`ト

***

## シチュエ`ションe

### 01. ボタンを作って画面移婴工
右下の丸四角マ`ク -> Button と 丸四角の View Controller をスト`リ`ボ`ドへドラッグ。<br>
右上の付{みたいなマ`ク -> 文字とか背景色を浃à椁欷搿<br>
Button から Ctrl ドラッグ -> Modal(deprecated)

### 02. 画面とYびついている ViewController の_J
AppDelegate.swift  アプリそのものの幼 「アプリ起婴筏郡樽畛酩嗽O定をiむ」とか「アプリがBGに移行するH、デ`タを保存する」など<br>
ViewController.swift  画面の表示をO定 storyboard画面のひとつずつとセットになってる<br>
Main.storyboard  画面レイアウトの配置<br>
storyboard のひとつの画面の上にあるオレンジのボタン(View Controller) -> 右上の新みたいなマ`ク(Identity inspector)<br>
Class のとこが空冥坤盲郡 File -> New -> File -> Cocoa Touch Class つくったら Class のとこにO定。

### 03. ボタンを押してラベルを浃à
Class を ViewController にYびつけたら、いちばん右上の丸がふたつ重なったボタン(アシスタントエディタモ`ド)。
```swift
@IBOutlet weak var inputField: UITextField!  // テキストフィ`ルドを Ctrl ドラッグ
@IBOutlet weak var textLabel: UILabel!  // ラベルを Ctrl ドラッグ

@IBAction func changeLabel(_ sender: Any) {  // ボタンを Ctrl ドラッグして Connection を Action にする。
    // ボタンが押されたときの幼鳏扦埂
    textLabel.text = inputField.text
}
```

### 04. パ`ツの配置がずれないようにする(Constraints)
パ`ツクリックして storyboard 下の |-□-| こんなマ`ク。

### 05. カメラロ`ルから画像をひっぱってきて表示する
これ}jすぎるからこのURLたほうがいい。<br>
[https://gigazine.net/news/20180125-make-ios-app-image-picker/](https://gigazine.net/news/20180125-make-ios-app-image-picker/)

### 06. storyboard ではOKなのにシミュレ`タでパ`ツがずれる。
左上にぶっとんでいるんだよな`なんで?

```
Constraints をちゃんとO定する。
```

### 07. 表示するところまではうまくいったけどキ`ボ`ドの表示に辘袱匹匹ストボックスを移婴丹护毪趣长恧钎ē椹`
```
setValue:forUndefinedKey:]: this class is not key value coding-compliant
```
一度 storyboard から swift につなげたパ`ツを swift 上でだけ削除すると起こる。<br>
右上の丸右矢印を押すと storyboard から swift につながってるパ`ツが表示される。そこからもう要らないやつを消せばよい。

### 08. キ`ボ`ドの表示に辘袱迫体を上にずらす
```swift
// これ、テキストボックスを connect したやつ。
@IBOutlet weak var inputField: UITextField! {
    didSet {
        inputField.delegate = self
    }
}

// あとはこの下をコピペすればいいよ。

override func viewWillAppear(_ animated: Bool) {
    
    super.viewWillAppear(animated)
    self.configureObserver()
    
}

override func viewWillDisappear(_ animated: Bool) {
    
    super.viewWillDisappear(animated)
    self.removeObserver() // Notificationを画面が消えるときに削除
}

// NotificationをO定
func configureObserver() {
    
    let notification = NotificationCenter.default
    notification.addObserver(self, selector: #selector(keyboardWillShow(notification:)), name: NSNotification.Name.UIKeyboardWillShow, object: nil)
    notification.addObserver(self, selector: #selector(keyboardWillHide(notification:)), name: NSNotification.Name.UIKeyboardWillHide, object: nil)
}

// Notificationを削除
func removeObserver() {
    
    let notification = NotificationCenter.default
    notification.removeObserver(self)
}

// キ`ボ`ドがFれたrに、画面全体をずらす。
@objc func keyboardWillShow(notification: Notification?) {
    
    let rect = (notification?.userInfo?[UIKeyboardFrameBeginUserInfoKey] as? NSValue)?.cgRectValue
    let duration: TimeInterval? = notification?.userInfo?[UIKeyboardAnimationDurationUserInfoKey] as? Double
    UIView.animate(withDuration: duration!, animations: { () in
        let transform = CGAffineTransform(translationX: 0, y: -(rect?.size.height)!)
        self.view.transform = transform
        
    })
}

// キ`ボ`ドが消えたときに、画面をす
@objc func keyboardWillHide(notification: Notification?) {
    
    let duration: TimeInterval? = notification?.userInfo?[UIKeyboardAnimationCurveUserInfoKey] as? Double
    UIView.animate(withDuration: duration!, animations: { () in
        
        self.view.transform = CGAffineTransform.identity
    })
}

func textFieldShouldReturn(_ textField: UITextField) -> Bool {
    
    textField.resignFirstResponder() // Returnキ`を押したときにキ`ボ`ドを下げる
    return true
}
```

### 09. とりあえずテ`ブルにモノを表示する
    1. TableView と TableViewCell を置く。
    2. 下 swift
```swift
// クラスに delegate と datasource を追加。
class ViewController: UIViewController,UITableViewDelegate,UITableViewDataSource {

    // もともとある viewDidLoad の中に追加。
    override func viewDidLoad() {

        // 略

        // テ`ブルの表示にvすることはこのクラスがやるという意R表明。
        table.delegate = self
        table.dataSource = self
    }

    // TableView をコネクトする。
    @IBOutlet weak var table: UITableView!

    // 表示するモノを浃工搿＝襻幛悉长欷拥膜摔扦たらいいんだよね?
    var texts = ["foo", "bar", "baz", "qux", "quux", "corge"]

    // これをく。ガワは class に@承を追加したとき出るエラ`で fix すればできる。
    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
        return texts.count
    }

    // これもく。同上。
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
        
        // Create the cell.
        let cell = UITableViewCell(style:UITableViewCellStyle.default, reuseIdentifier: "MyCell")

        // これをつけると、テ`ブルに二行以上表示できるようになる。
        cell.textLabel?.numberOfLines = 0

        // Make texts to show in the cell.
        cell.textLabel?.text = texts[indexPath.row]
        
        return cell
    }
}
```

### 10. ライブラリ管理ソフト CocoaPods

ネットにはもっとシンプルなコマンドが出てるけど、HighSierraではこうしないとダメっぽい。

```bash
$ sudo gem update --system -n /usr/local/bin
$ sudo gem install -n /usr/local/bin cocoapods
$ pod setup
$ pod init  # プロジェクトのディレクトリに移婴筏匹偿齑颏膜 Podfile が作られる。
```

Podfile の中にくものはライブラリによって`うので、それを参照してね。

### 11. XPC connection interrupted

少なくともこれ、 while がo限ル`プしたときに吐き出した。怪しいところはデバッグしよう。

### 12. SwiftyDropbox が使いたい

ここを参照。Qiitaとかにいろいろいてるけどやっぱり公式が正解だった。

[https://github.com/dropbox/SwiftyDropbox#get-started](https://github.com/dropbox/SwiftyDropbox#get-started)

### 13. UITabBarController でタブが切り替わるたびに何かしたい

下クラスを作って UITabBarController へ追加する。

```swift
import UIKit

class CustomUITabBarViewController: UITabBarController {


    // これ今のぼくにはワケワカメなのでとにかくく。
    override var selectedViewController: UIViewController? {
        get {
            return super.selectedViewController
        }
        set {
            let value = newValue
            super.selectedViewController = value
            self.tabChanged()
        }
    }


    // タブが切り替わるたびに起こしたいことをここにいてね!
    private func tabChanged() {

        // ここにやりたいことをけばよい!
        print("タブが切り替わった。")
    }
}
```

### 14. テキストビュ`に涓があるたび何かしたい

以下4w所をく。

```swift
// Delegateを追加。
class FirstViewController: UIViewController, UITextViewDelegate {

    // storyboardからつなぐ。
    @IBOutlet weak var textView: UITextView!

    // delegate=selfを追加。
    override func viewDidLoad() {
        super.viewDidLoad()
        textView.delegate = self
    }

    // ここにやりたいことをけばよい!
    func textViewDidChange(_ textView: UITextView) {
        print(textView.text)
    }
}
```

### 15. グロ`バル涫をつくってクラスをまたいでを使う

```swift
// AppDelegate の中にグロ`バル涫をO定する。
class AppDelegate: UIResponder, UIApplicationDelegate {
   
    // デ`タ受け渡し用グロ`バルフィ`ルド。
    var globalString01:String? = nil
}
```

```swift
// 使いたいときはどこでもOKなのでこうく。
let app:AppDelegate = UIApplication.shared.delegate as! AppDelegate
print(app.globalString01)
// 呼び出しもできるし格{もできる。
```

### 16. Dropbox J^を~させる、ただしJ^gみのときはJ^画面をスキップする

```swift
// このメソッドにかないとJ^画面が_かない。
override func viewDidAppear(_ animated: Bool) {
    
    // DropboxのJ^がされてないときはJ^gみフラグをオフにします。
    guard let client = DropboxClientsManager.authorizedClient else {
        DropboxClientsManager.authorizeFromController(
            UIApplication.shared,
            controller: self,
            openURL: {
                (url: URL) -> Void in UIApplication.shared.open(url)
            }
        )
        return
    }
}
```

### 17. キ`ボ`ド以外のとこタッチでキ`ボ`ドを]じる

これくだけでOK。

```swift
override func touchesBegan(_ touches: Set<UITouch>, with event: UIEvent?) {
    self.view.endEditing(true)
}
```

```swift

```
```swift

```

